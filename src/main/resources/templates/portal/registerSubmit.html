<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
    <title>注册</title>
    <div th:replace="~{fragments/head-base}"></div>
</head>
<body class="body sidebar-left-hidden fixedNav_position fixedMenu_left ">
<div class="preloader" style=" position: fixed;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  z-index: 100000;
  backface-visibility: hidden;
  background: #ffffff;">
    <div class="preloader_img" style="width: 200px;
  height: 200px;
  position: absolute;
  left: 48%;
  top: 48%;
  background-position: center;
z-index: 999999">
        <img th:src="@{/img/loader.gif}" style=" width: 50px;" alt="loading...">
    </div>
</div>
<!--wrap-->
<div id="wrap">
    <div th:replace="~{fragments/top :: top}"></div>
    <!-- /#top -->
    <div class="wrapper fixedNav_top">
        <div th:replace="~{fragments/left :: left}"></div>
        <!-- /#left -->
        <div id="content" class="bg-container">
            <div class="outer">
                <div class="inner bg-container">
                    <div class="row">
                        <div style="margin: 0 auto">
                            <div class="signin_wid m-t-35" style="width: 400px">
                                <!-- <div class="card-header bg-white">
                                     登录
                                 </div>-->
                                <div class=" ">
                                    <!-- logo -->
                                    <div class="m-t-30 text-center">
                                        <!--<img src="img/loginLogo.png" style="width: 300px"/>-->
                                        <h2 class="mt-4">欢迎加入洛谷 - 最后一步！</h2>
                                    </div>
                                    <form class=" mt-3" id="loginForm">
                                        <input type="hidden" name="token" th:value="${token}" />
                                        <input type="hidden" name="email" th:value="${email}" />
                                        <fieldset>
                                            <!-- Name input-->
                                            <div class="form-group row">

                                                <div class="col-lg-12 user_icon_change2">
                                                    <div class="input-group">
                                                            <span class="input-group-addon">
                                                                <i class="fa fa-user"></i>
                                                            </span>
                                                        <input type="text" class="form-control" maxlength="25"
                                                               minlength="6" id="username"
                                                               name="username" placeholder="账号，中英文下划线6-25位">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-lg-12">
                                                    <div class="input-group">
                                                            <span class="input-group-addon">
                                                            <i class="fa fa-lock"></i>
                                                        </span>
                                                        <input id="password" name="password" maxlength="30"
                                                               minlength="6" type="password" class="form-control"
                                                               placeholder="密码，6-30位">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-lg-12">
                                                    <div class="input-group">
                                                            <span class="input-group-addon">
                                                            <i class="fa fa-lock"></i>
                                                        </span>
                                                        <input id="rePassword" maxlength="30"
                                                               minlength="6" type="password" class="form-control"
                                                               placeholder="请再输入一遍">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-lg-12">
                                                    <div class="input-group">
                                                            <span class="input-group-addon">
                                                            <i class="fa fa-envelope"></i>
                                                        </span>
                                                        <input  id="email" disabled name="email" th:value="${email}" type="text"
                                                               class="form-control">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-3">
                                                    性别：
                                                </div>
                                                <div class="col-9">
                                                    <label class=" custom-control custom-radio">
                                                        <input name="sex" type="radio" value="男"
                                                               class="custom-control-input" checked="checked">
                                                        <span class="custom-control-indicator"></span>
                                                        <span class="custom-control-description">汉子</span>
                                                    </label>
                                                    <label class=" custom-control custom-radio">
                                                        <input name="sex" type="radio" value="女"
                                                               class="custom-control-input">
                                                        <span class="custom-control-indicator"></span>
                                                        <span class="custom-control-description">妹子</span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div>
                                                <label class="custom-control custom-checkbox mr-0">
                                                    <input onclick="disableButton()" type="checkbox"
                                                           class="custom-control-input"
                                                           checked="checked" id="agree" name="agree">
                                                    <span class="custom-control-indicator "></span>
                                                    <span>*我同意</span>
                                                </label>
                                                <a th:href="@{/}" target="_blank" class="text-primary">《用户协议》</a>
                                            </div>

                                            <div class="form-group row ">
                                                <div class="col-lg-8" style="margin: 0 auto">
                                                    <button id="registerSubmitBtn" type="button"
                                                            onclick="registerSubmitProcess()"
                                                            class="btn text-white btn-danger  w-100 btn-lg glow_button">
                                                        加入洛谷
                                                    </button>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.inner -->
    </div>
    <!-- /.outer -->
    <!-- /#content -->
    <!-- Modal -->
    <div class="modal fade" id="search_modal" tabindex="-1" role="dialog" aria-hidden="true">
        <form th:action="@{/problem/problemListPage}" method="post">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span class="float-right" aria-hidden="true">&times;</span>
                    </button>
                    <div class="input-group search_bar_small">
                        <input type="text" class="form-control" placeholder="题目搜索" name="keyword">
                        <span class="input-group-btn">
                          <button class="btn btn-secondary" type="submit"><i class="fa fa-search"></i></button>
                        </span>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <!-- /#content -->
    <!-- # right side -->
</div>
<!-- /#wrap -->
<!-- global scripts-->
<div th:replace="~{fragments/footer :: footer}"></div>
<!--end of global scripts-->
<!--  plugin scripts -->
<script th:src="@{/js/pages/registerSubmit.js}"></script>
<!--end of plugin scripts-->
<script th:inline="javascript" type="text/javascript">
    /*<![CDATA[*/
    function registerSubmitProcess() {
        var username = $("#username").val();
        var password = $("#password").val();
        var rePassword = $("#rePassword").val();
        if (!username || !password || !rePassword) {
            $.message({
                message: '输入不能为空',
                type: 'warning'
            });
            return;
        }
        if (rePassword != password) {
            $.message({
                message: '两次密码不相等',
                type: 'warning'
            });
            return;
        }
        if (password.length < 6) {
            $.message({
                message: '密码不能少于６个字符',
                type: 'warning'
            });
            return;
        }
        var data = $("#loginForm").serialize();

        $.post("user/registerSubmitProcess", data, function (resp) {
            if (resp.status == 200) {
                $.message({
                    message: '注册成功',
                    type: 'success'
                });
            } else {
                $.message({
                    message: resp.msg,
                    type: 'error'
                });
            }
        });
    }
    function disableButton() {
        if($("#agree").prop("checked")){
            $("#registerSubmitBtn").removeAttr("disabled");
        }else {
            $("#registerSubmitBtn").attr("disabled", "disabled");
        }
    }

    /*]]>*/
</script>

</body>

</html>
